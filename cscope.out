cscope 15 $HOME/PL -q 0000000161 0000022439
	@fsa.cc

4 
	~<io¡»am
>

6 
	~"f§.h
"

8 
	#DISABLE_LOG
 
Œue


	)

9 
	#LOG
 \

10 ià(
DISABLE_LOG
è{} 
¡d
::
û¼


	)

12 
usšg
 
Çme¥aû
 
	g¡d
;

14 
boŞ
 
	$RunFSA
(cÚ¡ 
Fš™eS‹Autom©Ú
& 
f§
, cÚ¡ 
¡ršg
& 
¡r
) {

16 
m­
<
¡ršg
, sŒšg>::
cÚ¡_™”©Ü
 
™”
;

17 
¡ršg
 
Œªs™iÚ
,
isfš®
;

18 
šdex
 = 0;

19 
šput
 = 
¡r
[0];

22 
¡ršg
 
cur_¡©e
 = 
	`Chªge_to_¡ršg
(1);

25 
¡r
[
šdex
] != '\0'){

27 
Œªs™iÚ
 = 
cur_¡©e
 + 
šput
;

29 
™”
 = (
f§
.
bË
).
	`fšd
(
Œªs™iÚ
);

31 if(
™”
 !ğ
f§
.
bË
.
	`’d
())

33 
cur_¡©e
 = 
™”
->
£cÚd
;

36  
çl£
;

38 
šdex
++;

40 
šput
 = 
¡r
[
šdex
];

43 
isfš®
 = 
cur_¡©e
;

45 
i
 = 0; i < 
f§
.
acû±
.
	`size
(); i++){

46 
j
 = 0; j < 
isfš®
.
	`size
(); j++){

47 if(
f§
.
acû±
[
i
] =ğ()(
isfš®
[
j
]-'0'))

48  
Œue
;

52  
çl£
;

53 
	}
}

55 
boŞ
 
BudFSA
(cÚ¡ 
¡d
::
veùÜ
<
FSATabËEËm’t
>& 
–em’ts
,

56 cÚ¡ 
¡d
::
veùÜ
<>& 
acû±_¡©es
,

57 
Fš™eS‹Autom©Ú
* 
f§
) {

59 
	g¡d
::
veùÜ
<
FSATabËEËm’t
>::
cÚ¡_™”©Ü
 
–em_™”
;

60 
	g¡d
::
veùÜ
<
–em
> 
¡Üage
;

61 
	gnç
 = 0;

66 
	g–em_™”
 = 
–em’ts
.
begš
();ƒËm_™” !ğ–em’ts.
’d
();ƒlem_iter++){

67 
–em
 
	gÃw_–em
;

69 
	gÃw_–em
.
	g¡©e
 = 
–em_™”
->
¡©e
;

70 
	gÃw_–em
.
	gÃxt_¡©e
 = 
–em_™”
->
Ãxt_¡©e
;

72 if(
	g–em_™”
->
	g¡r
.
size
() > 1){

73 
	gi
 = 0; i < 
	g–em_™”
->
	g¡r
.
size
(); i++){

74 
	gtmp
 = 
–em_™”
->
¡r
[
i
];

76 if(
	gi
 == 0){

77 
Ãw_–em
.
šput
 = 
tmp
;

80 
–em
 
	gtmp_–em
;

82 
	gtmp_–em
.
	g¡©e
 = 
–em_™”
->
¡©e
;

83 
	gtmp_–em
.
	gÃxt_¡©e
 = 
–em_™”
->
¡©e
;

84 
	gtmp_–em
.
	gšput
 = 
tmp
;

86 
	g¡Üage
.
push_back
(
tmp_–em
);

89 
	g¡Üage
.
push_back
(
Ãw_–em
);

92 if(
	g–em_™”
->
	g¡r
.
em±y
() == 1){

93 
Ãw_–em
.
šput
 = 0;

95 
	g¡Üage
.
push_back
(
Ãw_–em
);

99 
	gtmp
 = 
–em_™”
->
¡r
[0];

101 
	gÃw_–em
.
	gšput
 = 
tmp
;

103 
	g¡Üage
.
push_back
(
Ãw_–em
);

110 
	gi
 = 0; i < 
	g¡Üage
.
size
(); i++){

111 if(
	g¡Üage
[
i
].
	gšput
 == 0){

112 
nç
 = 1;

117 
	gi
 = 0; i < 
	g¡Üage
.
size
(); i++){

118 
	gj
 = 
i
+1; j < 
	g¡Üage
.
size
(); j++){

120 if(
	g¡Üage
[
i
].
	g¡©e
 =ğ
¡Üage
[
j
].
¡©e
 && stÜage[i].
šput
 == storage[j].input){

121 
nç
 = 1;

125 if(
	gnç
)

132 if(!
	gnç
){

133 
¡ršg
 
	gŒªs™iÚ
, 
	gÃxt
;

138 
	gi
 = 0; i < 
	g¡Üage
.
size
(); i++){

139 
	gŒªs™iÚ
 = 
Chªge_to_¡ršg
(
¡Üage
[
i
].
¡©e
è+ stÜage[i].
šput
;

140 
	gÃxt
 = 
Chªge_to_¡ršg
(
¡Üage
[
i
].
Ãxt_¡©e
);

141 
	gf§
->
	gbË
[
Œªs™iÚ
] = 
Ãxt
;

145 
	gi
 = 0; i < 
	gacû±_¡©es
.
size
(); i++){

146 
	gf§
->
	gacû±
.
push_back
(
acû±_¡©es
[
i
]);

152 
	gi
 = 0; i < 
	g¡Üage
.
size
(); i++){

154 if(
	g¡Üage
[
i
].
	gšput
 != '0')

155 
f§
->
šput_li¡
.
š£¹
(
¡Üage
[
i
].
šput
);

157 
Make_nç_bË
(
¡Üage
, 
f§
);

160 
	gi
 = 0; i < 
	gacû±_¡©es
.
size
(); i++)

161 
	gf§
->
	gacû±
.
push_back
(
acû±_¡©es
[
i
]);

164 
	gLOG
 << "num_–em’ts: " << 
	g–em’ts
.
size
()

165 << ",‡cû±_¡©es: " << 
	gacû±_¡©es
.
size
(è<< 
	g’dl
;

167 if(
	g–em’ts
.
size
() <= 0)

168  
çl£
;

170  
	gŒue
;

173 
	g¡d
::
¡ršg
 
Check_•sÚ
(cÚ¡ 
¡d
::
veùÜ
<
–em
>& 
¡Üage
, 
¡©e
){

174 
	g¡ack
<> 
	g¡©e_¡ack
;

175 
	g£t
<> 
	gavaabË_¡©e
;

176 
	g£t
<>::
™”©Ü
 
™”
;

177 
¡ršg
 
	gşu¡”
;

178 
	gtİ
,
	gşu¡”_size
;

181 
	g¡©e_¡ack
.
push
(
¡©e
);

182 
	gavaabË_¡©e
.
š£¹
(
¡©e
);

185 !
	g¡©e_¡ack
.
em±y
()){

186 
	gtİ
 = 
¡©e_¡ack
.
tİ
();

187 
	g¡©e_¡ack
.
pİ
();

189 
	gi
 = 0; i < 
	g¡Üage
.
size
(); i++){

191 if(
	g¡Üage
[
i
].
	g¡©e
 =ğ
tİ
 && 
¡Üage
[i].
šput
 == 0){

192 
şu¡”_size
 = 
avaabË_¡©e
.
size
();

194 
	gavaabË_¡©e
.
š£¹
(
¡Üage
[
i
].
Ãxt_¡©e
);

198 if(
	gavaabË_¡©e
.
size
(è!ğ
şu¡”_size
)

199 
¡©e_¡ack
.
push
(
¡Üage
[
i
].
Ãxt_¡©e
);

205 
	g™”
 = 
avaabË_¡©e
.
begš
(); i‹¸!ğavaabË_¡©e.
’d
(); iter++)

206 
	gşu¡”
.
­³nd
(
Chªge_to_¡ršg
(*
™”
));

208  
	gşu¡”
;

211 
	g¡d
::
¡ršg
 
Check_Ãxt
(cÚ¡ 
¡d
::
veùÜ
<
–em
>& 
¡Üage
, 
¡©e
, 
šput
){

212 
¡ršg
 
	gcur_¡©e
;

213 
¡ršg
 
	gÃxt_şu¡”
,
	gÃxt_¡ršg
;

214 
	g£t
<> 
	gÃxt_£t
;

215 
	g£t
<>::
™”©Ü
 
™”
;

216 
	gcur_p›û
,
	gÃxt_¡©e
;

219 
	gcur_¡©e
 = 
Check_•sÚ
(
¡Üage
, 
¡©e
);

221 
	gi
 = 0; i < 
	gcur_¡©e
.
size
(); i++){

223 
	gcur_p›û
 = ()(
cur_¡©e
.
©
(
i
) - '0');

224 
	gj
 = 0; j < 
	g¡Üage
.
size
(); j++){

226 if(
	gcur_p›û
 =ğ
¡Üage
[
j
].
¡©e
 && 
šput
 == storage[j].input){

227 
Ãxt_£t
.
š£¹
(
¡Üage
[
j
].
Ãxt_¡©e
);

232 
	g™”
 = 
Ãxt_£t
.
begš
(); i‹¸!ğÃxt_£t.
’d
(); iter++){

234 
	gÃxt_şu¡”
 = 
Check_•sÚ
(
¡Üage
, *
™”
);

236 
	gi
 = 0; i < 
	gÃxt_şu¡”
.
size
(); i++){

237 
	gÃxt_¡©e
 = ()(
Ãxt_şu¡”
[
i
] - '0');

238 
	gÃxt_£t
.
š£¹
(
Ãxt_¡©e
);

242 
	g™”
 = 
Ãxt_£t
.
begš
(); i‹¸!ğÃxt_£t.
’d
(); iter++){

243 
	gÃxt_¡ršg
.
­³nd
(
Chªge_to_¡ršg
(*
™”
));

245  
	gÃxt_¡ršg
;

248 
	g¡d
::
¡ršg
 
Fšd_Ãxt
(cÚ¡ 
¡d
::
veùÜ
<
–em
>& 
¡Üage
, std::¡ršg 
¡©e
, 
šput
){

249 
	gcur_p›û
,
	gÃxt_p›û
;

250 
¡ršg
 
	gÃxt_şu¡”
, 
	gÃxt_¡ršg
;

251 
	g£t
<> 
	gÃxt_£t
;

252 
	g£t
<>::
™”©Ü
 
™”
;

257 
	gi
 = 0; i < 
	g¡©e
.
size
(); i++){

258 
	gcur_p›û
 = ()(
¡©e
[
i
] - '0');

259 
	gÃxt_şu¡”
 = 
Check_Ãxt
(
¡Üage
,
cur_p›û
,
šput
);

264 
	gj
 = 0; j < 
	gÃxt_şu¡”
.
size
(); j++){

265 
	gÃxt_p›û
 = ()(
Ãxt_şu¡”
[
j
] - '0');

266 
	gÃxt_£t
.
š£¹
(
Ãxt_p›û
);

270 
	g™”
 = 
Ãxt_£t
.
begš
(); i‹¸!ğÃxt_£t.
’d
(); iter++)

271 
	gÃxt_¡ršg
.
­³nd
(
Chªge_to_¡ršg
(*
™”
));

273  
	gÃxt_¡ršg
;

278 
Make_nç_bË
(cÚ¡ 
¡d
::
veùÜ
<
–em
>& 
¡Üage
, 
Fš™eS‹Autom©Ú
 *
f§
){

279 
	g¡ack
<
	g¡ršg
> 
	g¡©e_¡ack
;

280 
	g£t
<>::
™”©Ü
 
™”
;

281 
	g£t
<
	g¡ršg
> 
	gexi¡
;

283 
¡ršg
 
	gcur_¡©e
 = 
Chªge_to_¡ršg
(1);

284 
¡ršg
 
	gŒªs™iÚ
,
	gÃxt_¡©e
;

286 
	g¡©e_¡ack
.
push
(
cur_¡©e
);

287 
	gexi¡
.
š£¹
(
cur_¡©e
);

289 !
	g¡©e_¡ack
.
em±y
()){

290 
	gcur_¡©e
 = 
¡©e_¡ack
.
tİ
();

292 
	g¡©e_¡ack
.
pİ
();

293 
	g™”
 = 
f§
->
šput_li¡
.
begš
(); i‹¸!ğf§->šput_li¡.
’d
(); iter++){

297 
	gÃxt_¡©e
 = 
Fšd_Ãxt
(
¡Üage
,
cur_¡©e
,*
™”
);

298 
	gŒªs™iÚ
 = 
cur_¡©e
 + *
™”
;

301 
	gf§
->
	gbË
[
Œªs™iÚ
] = 
Ãxt_¡©e
;

304 if(
	gcur_¡©e
 !ğ
Ãxt_¡©e
 && 
exi¡
.
fšd
Òext_¡©eè=ğexi¡.
’d
()){

305 
¡©e_¡ack
.
push
(
Ãxt_¡©e
);

306 
	gexi¡
.
š£¹
(
Ãxt_¡©e
);

312 
¡ršg
 
	$Chªge_to_¡ršg
(
num
){

313 
¡ršg
 
¡r
;

314 
tmp_ch¬
;

317 
tmp_ch¬
 = ()
num
 + '0';

319 
¡r
 = 
tmp_ch¬
;

321  
¡r
;

322 
	}
}

	@fsa.h

4 #iâdeà
_PL_HOMEWORK_FSA_H_


5 
	#_PL_HOMEWORK_FSA_H_


	)

7 
	~<£t
>

8 
	~<¡ršg
>

9 
	~<m­
>

10 
	~<veùÜ
>

11 
	~<¡ack
>

16 
	sFSATabËEËm’t
 {

17 
	m¡©e
;

18 
	mÃxt_¡©e
;

19 
	m¡d
::
¡ršg
 
¡r
;

26 
	s–em
{

27 
	m¡©e
;

28 
	mÃxt_¡©e
;

29 
	mšput
;

32 
	sFš™eS‹Autom©Ú
 {

34 
	m¡d
::
veùÜ
<> 
acû±
;

35 
	m¡d
::
£t
<> 
šput_li¡
;

36 
	m¡d
::
m­
<
¡d
::
¡ršg
, std::¡ršg> 
bË
;

40 
boŞ
 
RunFSA
(cÚ¡ 
Fš™eS‹Autom©Ú
& 
f§
, cÚ¡ 
¡d
::
¡ršg
& 
¡r
);

42 
boŞ
 
BudFSA
(cÚ¡ 
¡d
::
veùÜ
<
FSATabËEËm’t
>& 
–em’ts
,

43 cÚ¡ 
¡d
::
veùÜ
<>& 
acû±_¡©es
,

44 
Fš™eS‹Autom©Ú
* 
f§
);

45 
	g¡d
::
¡ršg
 
Check_•sÚ
(cÚ¡ 
¡d
::
veùÜ
<
–em
>& 
¡Üage
, 
¡©e
);

46 
	g¡d
::
¡ršg
 
Check_Ãxt
(cÚ¡ 
¡d
::
veùÜ
<
–em
>& 
¡Üage
, 
¡©e
, 
šput
);

47 
	g¡d
::
¡ršg
 
Fšd_Ãxt
(cÚ¡ 
¡d
::
veùÜ
<
–em
>& 
¡Üage
, std::¡ršg 
¡©e
, 
šput
);

48 
Make_nç_bË
(cÚ¡ 
¡d
::
veùÜ
<
–em
>& 
¡Üage
, 
Fš™eS‹Autom©Ú
 *
f§
);

49 
	g¡d
::
¡ršg
 
Chªge_to_¡ršg
(
num
);

	@fsa_main.cc

4 
	~<¡dio.h
>

5 
	~<¡ršg
>

6 
	~<¡ršg.h
>

7 
	~<io¡»am
>

8 
	~<s¡»am
>

9 
	~<veùÜ
>

11 
	~"f§.h
"

13 
usšg
 
Çme¥aû
 
	g¡d
;

15 
boŞ
 
LßdFSA
(cÚ¡ * 
f’ame
,

16 
veùÜ
<
FSATabËEËm’t
>* 
f§_–em’ts
,

17 
veùÜ
<>* 
acû±_¡©es
) {

18 
FILE
* 
	gå
 = 
fİ’
(
f’ame
, "rt");

19 ià(
	gå
 =ğ
NULL
è 
çl£
;

21 
	gf§_–em’ts
->
ş—r
();

22 
	gacû±_¡©es
->
ş—r
();

24 
	gbuf
[1024];

25 
fg‘s
(
buf
, 1024, 
å
);

26 
i¡ršg¡»am
 
iss
(
buf
);

27 
	giss
.
good
()) {

28 
	gacû±_¡©e
;

29 
	giss
 >> 
	gacû±_¡©e
;

30 
	gacû±_¡©es
->
push_back
(
acû±_¡©e
);

33 !
ãof
(
å
)) {

34 
FSATabËEËm’t
 
	g–em
;

35 
	g¡r_buf
[1024] = "";

36 ià(
fsÿnf
(
å
, "%d %d %s", &
–em
.
¡©e
, &–em.
Ãxt_¡©e
, 
¡r_buf
) < 3) {

39 ià(
¡rcmp
(
¡r_buf
, "#"è!ğ0è
–em
.
¡r
 = str_buf;

40 
	gf§_–em’ts
->
push_back
(
–em
);

42 
fşo£
(
å
);

43  
	gŒue
;

46 
	$maš
(
¬gc
, ** 
¬gv
) {

47 ià(
¬gc
 != 2) {

48 
û¼
 << "givehe FSA file.\n";

51 
veùÜ
<
FSATabËEËm’t
> 
f§_–em’ts
;

52 
veùÜ
<> 
acû±_¡©es
;

53 ià(
	`LßdFSA
(
¬gv
[1], &
f§_–em’ts
, &
acû±_¡©es
è=ğ
çl£
) {

54 
û¼
 << "uÇbËØlßdhFSA f" << 
¬gv
[1] << ".\n";

57 
Fš™eS‹Autom©Ú
 
f§
;

58 ià(
	`BudFSA
(
f§_–em’ts
, 
acû±_¡©es
, &
f§
è=ğ
çl£
) {

59 
û¼
 << "uÇbËØbudhFSA (" << 
¬gv
[1] << ").\n";

63 
¡ršg
 
šput_¡r
;

64 !
cš
.
	`eof
()) {

66 
cout
 << "> ";

67 
¡d
::
	`g‘lše
(
cš
, 
šput_¡r
);

68 
boŞ
 
acû±
 = 
	`RunFSA
(
f§
, 
šput_¡r
.
	`c_¡r
());

69 
cout
 << "šput: '" << 
šput_¡r
 << "' = " << (
acû±
? "O" : "X"è<< 
’dl
;

72 
	}
}

	@lr_parser.cc

4 
	~<as£¹.h
>

6 
	~<io¡»am
>

7 
	~<veùÜ
>

8 
	~<¡ack
>

10 
	~"Ì_·r£r.h
"

12 
	#DISABLE_LOG
 
çl£


	)

13 
	#LOG
 \

14 ià(
DISABLE_LOG
è{} 
¡d
::
û¼


	)

16 
usšg
 
Çme¥aû
 
	g¡d
;

18 
boŞ
 
BudLRP¬£r
(cÚ¡ 
¡d
::
veùÜ
<
LRTabËEËm’t
>& 
–em’ts
,

19 cÚ¡ 
¡d
::
veùÜ
<
LRRuË
>& 
ruËs
,

20 
LRP¬£r
* 
Ì_·r£r
) {

24 
	gi
 = 0; i < 
	g–em’ts
.
size
(); i++)

25 
	gÌ_·r£r
->
	gbË
.
push_back
(
–em’ts
[
i
]);

27 
	gi
 = 0; i < 
	gruËs
.
size
(); i++)

28 
	gÌ_·r£r
->
	gruËs
.
push_back
(
ruËs
[
i
]);

30  
	gŒue
;

33 
boŞ
 
	$RunLRP¬£r
(cÚ¡ 
LRP¬£r
& 
Ì_·r£r
, cÚ¡ 
¡d
::
¡ršg
& 
¡r
) {

34 
¡ack
<> 
Ì_¡ack
;

35 
šdex
 = 0;

36 
pİ_num
 = 0;

37 
·œ
<
LRAùiÚ
, > 
Ãxt
;

38 
·œ
<
LRAùiÚ
, > 
go_to
;

41 
Ì_¡ack
.
	`push
(0);

45 
šdex
 !ğ
¡r
.
	`size
()){

47 
Ãxt
 = 
	`M©ch
(
Ì_·r£r
.
bË
,
Ì_¡ack
.
	`tİ
(),
¡r
[
šdex
]);

51 if(
Ãxt
.
fœ¡
 =ğ
INVALID
){

52  
çl£
;

56 if(
Ãxt
.
fœ¡
 =ğ
SHIFT
){

58 
Ì_¡ack
.
	`push
(
¡r
[
šdex
++]);

59 
Ì_¡ack
.
	`push
(
Ãxt
.
£cÚd
);

62 if(
Ãxt
.
fœ¡
 =ğ
REDUCE
){

66 
pİ_num
 = 
Ì_·r£r
.
ruËs
[
Ãxt
.
£cÚd
 - 1].
num_rhs
 * 2;

74 
i
 = 0; i < 
pİ_num
; i++)

75 
Ì_¡ack
.
	`pİ
();

79 
go_to
 = 
	`M©ch
(
Ì_·r£r
.
bË
, 
Ì_¡ack
.
	`tİ
(),†r_·r£r.
ruËs
[
Ãxt
.
£cÚd
-1].
lhs_symbŞ
);

82 
Ì_¡ack
.
	`push
(
Ì_·r£r
.
ruËs
[
Ãxt
.
£cÚd
 -1].
lhs_symbŞ
);

85 if(
go_to
.
fœ¡
 !ğ
GOTO
)

86  
çl£
;

89 
Ì_¡ack
.
	`push
(
go_to
.
£cÚd
);

92 if(
Ãxt
.
fœ¡
 =ğ
ACCEPT
)

93  
Œue
;

95  
çl£
;

96 
	}
}

98 
	g·œ
<
	gLRAùiÚ
, > 
M©ch
(
veùÜ
<
LRTabËEËm’t
> 
bË
, 
¡©e
, 
symbŞ
){

99 
	gi
 = 0; i < 
	gbË
.
size
(); i++){

101 if(
	gbË
[
i
].
	g¡©e
 =ğ
¡©e
 && 
bË
[i].
symbŞ
 == symbol){

102  
make_·œ
(
bË
.
©
(
i
).
aùiÚ
,abË.©(i).
Ãxt_¡©e
);

106  
make_·œ
(
INVALID
, -1);

	@lr_parser.h

4 #iâdeà
_PL_HOMEWORK_LR_PARSER_H_


5 
	#_PL_HOMEWORK_LR_PARSER_H_


	)

7 
	~<¡ršg
>

8 
	~<veùÜ
>

10 
	eLRAùiÚ
 {

11 
	mINVALID
 = 0,

12 
	mSHIFT
 = 1,

13 
	mREDUCE
 = 2,

14 
	mACCEPT
 = 3,

15 
	mGOTO
 = 4

24 
	sLRTabËEËm’t
 {

25 
	m¡©e
;

26 
	msymbŞ
;

27 
LRAùiÚ
 
	maùiÚ
;

28 
	mÃxt_¡©e
;

31 
	sLRRuË
 {

32 
	mid
;

33 
	mlhs_symbŞ
;

34 
	mnum_rhs
;

37 
	sLRP¬£r
 {

39 
	m¡d
::
veùÜ
<
LRTabËEËm’t
> 
bË
;

40 
	m¡d
::
veùÜ
<
LRRuË
> 
ruËs
;

44 
boŞ
 
BudLRP¬£r
(cÚ¡ 
¡d
::
veùÜ
<
LRTabËEËm’t
>& 
–em’ts
,

45 cÚ¡ 
¡d
::
veùÜ
<
LRRuË
>& 
ruËs
,

46 
LRP¬£r
* 
Ì_·r£r
);

49 
boŞ
 
RunLRP¬£r
(cÚ¡ 
LRP¬£r
& 
Ì_·r£r
, cÚ¡ 
¡d
::
¡ršg
& 
¡r
);

50 
	g¡d
::
·œ
<
LRAùiÚ
, > 
M©ch
(
¡d
::
veùÜ
<
LRTabËEËm’t
> 
bË
, 
¡©e
, 
symbŞ
);

	@lr_parser_main.cc

4 
	~<¡dio.h
>

5 
	~<¡dlib.h
>

7 
	~<io¡»am
>

8 
	~<s¡»am
>

9 
	~<¡ršg
>

10 
	~<veùÜ
>

12 
	~"Ì_·r£r.h
"

14 
usšg
 
Çme¥aû
 
	g¡d
;

16 
boŞ
 
LßdLRTabË
(cÚ¡ * 
f’ame
,

17 
veùÜ
<
LRTabËEËm’t
>* 
–em’ts
, veùÜ<
LRRuË
>* 
ruËs
) {

18 
FILE
* 
	gå
 = 
fİ’
(
f’ame
, "rt");

19 ià(
	gå
 =ğ
NULL
è 
çl£
;

21 
	g–em’ts
->
ş—r
();

22 
	gruËs
->
ş—r
();

24 
	gnum_–em’ts
, 
	gnum_ruËs
;

25 ià(
fsÿnf
(
å
, "%d %d", &
num_–em’ts
, &
num_ruËs
è< 2è 
	gçl£
;

27 
	gi
 = 0; i < 
	gnum_–em’ts
; ++i) {

28 
LRTabËEËm’t
 
	g–em
;

29 
	gaùiÚ
, 
	gsymbŞ
[64];

30 ià(
fsÿnf
(
å
, "%d %s %c %d",

31 &
–em
.
¡©e
, 
symbŞ
, &
aùiÚ
, &–em.
Ãxt_¡©e
) < 4) {

34 
	g–em
.
	gaùiÚ
 = (
aùiÚ
 =ğ'S' ? 
SHIFT
 :‡ùiÚ =ğ'R' ? 
REDUCE
 :

35 
aùiÚ
 =ğ'G' ? 
GOTO
 :‡ùiÚ =ğ'A' ? 
ACCEPT
 : 
INVALID
);

36 ià(
	g–em
.
	gaùiÚ
 =ğ
GOTO
è
–em
.
symbŞ
 = 
©oi
(symbol);

37 ià(
	g–em
.
	gaùiÚ
 =ğ
INVALID
è
–em
.
symbŞ
 = 0;

38 
	g–em
.
	gsymbŞ
 = 
symbŞ
[0];

39 
	g–em’ts
->
push_back
(
–em
);

41 
	gi
 = 0; i < 
	gnum_ruËs
; ++i) {

42 
LRRuË
 
	gruË
;

43 ià(
fsÿnf
(
å
, "%d %d %d", &
ruË
.
id
, &ruË.
lhs_symbŞ
, &ruË.
num_rhs
) < 3) {

46 
	gruËs
->
push_back
(
ruË
);

48 
fşo£
(
å
);

49  
	gŒue
;

52 
	$maš
(
¬gc
, ** 
¬gv
) {

53 ià(
¬gc
 != 2) {

54 
û¼
 << "givehe LRable file.\n";

57 
veùÜ
<
LRTabËEËm’t
> 
–em’ts
;

58 
veùÜ
<
LRRuË
> 
ruËs
;

59 ià(
	`LßdLRTabË
(
¬gv
[1], &
–em’ts
, &
ruËs
è=ğ
çl£
) {

60 
û¼
 << "uÇbËØlßdhLRabË f" << 
¬gv
[1] << ".\n";

63 
LRP¬£r
 
Ì_·r£r
;

64 ià(
	`BudLRP¬£r
(
–em’ts
, 
ruËs
, &
Ì_·r£r
è=ğ
çl£
) {

65 
û¼
 << "uÇbËØbudhLR…¬£¸(" << 
¬gv
[1] << ").\n";

69 
¡ršg
 
šput_¡r
;

70 !
cš
.
	`eof
()) {

72 
cout
 << "> ";

73 
¡d
::
	`g‘lše
(
cš
, 
šput_¡r
);

74 
šput_¡r
 += "$";

75 
boŞ
 
acû±
 = 
	`RunLRP¬£r
(
Ì_·r£r
, 
šput_¡r
);

76 
cout
 << "šput: '" << 
šput_¡r
 << "' = " << (
acû±
? "O" : "X"è<< 
’dl
;

79 
	}
}

	@regexp_main.cc

4 
	~<¡dio.h
>

6 
	~<io¡»am
>

7 
	~<s¡»am
>

8 
	~<¡ršg
>

9 
	~<veùÜ
>

11 
	~"»gexp_m©ch”.h
"

13 
usšg
 
Çme¥aû
 
	g¡d
;

15 
	$maš
(
¬gc
, ** 
¬gv
) {

16 ià(
¬gc
 != 2) {

17 
û¼
 << "givehe„egexp…attern.\n";

20 
RegExpM©ch”
 
»gexp
;

21 ià(
	`BudRegExpM©ch”
(
¬gv
[1], &
»gexp
è=ğ
çl£
) {

22 
û¼
 << "uÇbËØbudhm©ch” from„egex°'" << 
¬gv
[1] << "'.\n";

26 
¡ršg
 
šput_¡r
;

27 !
cš
.
	`eof
()) {

29 
cout
 << "> ";

30 
¡d
::
	`g‘lše
(
cš
, 
šput_¡r
);

31 
boŞ
 
acû±
 = 
	`RunRegExpM©ch”
(
»gexp
, 
šput_¡r
.
	`c_¡r
());

32 
cout
 << "šput: '" << 
šput_¡r
 << "' = " << (
acû±
? "O" : "X"è<< 
’dl
;

35 
	}
}

	@regexp_matcher.cc

4 
	~<io¡»am
>

5 
	~"»gexp_m©ch”.h
"

7 
usšg
 
Çme¥aû
 
	g¡d
;

9 
boŞ
 
	$BudRegExpM©ch”
(cÚ¡ * 
»gexp
, 
RegExpM©ch”
* 
»gexp_m©ch”
) {

11 
nç
 = 0;

12 
cur_¡©e
 = 1;

13 
Ãxt_¡©e
 = 
cur_¡©e
 + 1;

14 
šdex
 = 0;

15 
veùÜ
<> 
acû±_¡©es
;

25 
»gexp
[
šdex
] != '\0'){

26 
–em
 
Ãw_–em
;

28 
»gexp
[
šdex
]){

39 
šdex
++;

45 
	`Check_Ü
(
»gexp
,
»gexp_m©ch”
,&
cur_¡©e
,&
Ãxt_¡©e
,&
šdex
);

59 
šdex
++;

64 
Ãw_–em
.
¡©e
 = 
cur_¡©e
;

65 
Ãw_–em
.
Ãxt_¡©e
 =‚ext_state;

66 
Ãw_–em
.
šput
 = 
»gexp
[
šdex
];

68 
cur_¡©e
++;

69 
Ãxt_¡©e
++;

70 
šdex
++;

72 
»gexp_m©ch”
->
¡Üage
.
	`push_back
(
Ãw_–em
);

78 
acû±_¡©es
.
	`push_back
(
cur_¡©e
);

83 
i
 = 0; i < 
»gexp_m©ch”
->
¡Üage
.
	`size
(); i++){

84 if(
»gexp_m©ch”
->
¡Üage
[
i
].
šput
 == 0){

85 
nç
 = 1;

90 
i
 = 0; i < 
»gexp_m©ch”
->
¡Üage
.
	`size
(); i++){

91 
j
 = 
i
+1; j < 
»gexp_m©ch”
->
¡Üage
.
	`size
(); j++){

93 if(
»gexp_m©ch”
->
¡Üage
[
i
].
¡©e
 =ğ»gexp_m©ch”->¡Üage[
j
].¡©&&„egexp_m©ch”->¡Üage[i].
šput
 ==„egexp_matcher->storage[j].input){

94 
nç
 = 1;

98 if(
nç
)

105 if(!
nç
){

106 
¡ršg
 
Œªs™iÚ
, 
Ãxt
;

111 
i
 = 0; i < 
»gexp_m©ch”
->
¡Üage
.
	`size
(); i++){

112 
Œªs™iÚ
 = 
	`IÁeg”_to_¡ršg
(
»gexp_m©ch”
->
¡Üage
[
i
].
¡©e
è+„egexp_m©ch”->¡Üage[i].
šput
;

113 
Ãxt
 = 
	`IÁeg”_to_¡ršg
(
»gexp_m©ch”
->
¡Üage
[
i
].
Ãxt_¡©e
);

114 
»gexp_m©ch”
->
f§
.
bË
[
Œªs™iÚ
] = 
Ãxt
;

118 
i
 = 0; i < 
acû±_¡©es
.
	`size
(); i++){

119 
»gexp_m©ch”
->
f§
.
acû±
.
	`push_back
(
acû±_¡©es
[
i
]);

125 
i
 = 0; i < 
»gexp_m©ch”
->
¡Üage
.
	`size
(); i++){

127 if(
»gexp_m©ch”
->
¡Üage
[
i
].
šput
 != '0')

128 
»gexp_m©ch”
->
f§
.
šput_li¡
.
	`š£¹
Ôegexp_m©ch”->
¡Üage
[
i
].
šput
);

130 
	`Make_nç_bË
(
»gexp_m©ch”
);

133 
i
 = 0; i < 
acû±_¡©es
.
	`size
(); i++)

134 
»gexp_m©ch”
->
f§
.
acû±
.
	`push_back
(
acû±_¡©es
[
i
]);

137  
Œue
;

138 
	}
}

140 
boŞ
 
	$RunRegExpM©ch”
(cÚ¡ 
RegExpM©ch”
& 
»gexp_m©ch”
, cÚ¡ * 
¡r
) {

142 
m­
<
¡ršg
, sŒšg>::
cÚ¡_™”©Ü
 
™”
;

143 
¡ršg
 
Œªs™iÚ
,
isfš®
;

144 
šdex
 = 0;

145 
šput
 = 
¡r
[0];

148 
¡ršg
 
cur_¡©e
 = 
	`IÁeg”_to_¡ršg
(1);

151 
¡r
[
šdex
] != '\0'){

153 
Œªs™iÚ
 = 
cur_¡©e
 + 
šput
;

155 
™”
 = (
»gexp_m©ch”
.
f§
.
bË
).
	`fšd
(
Œªs™iÚ
);

157 if(
™”
 !ğ
»gexp_m©ch”
.
f§
.
bË
.
	`’d
())

159 
cur_¡©e
 = 
™”
->
£cÚd
;

162  
çl£
;

164 
šdex
++;

166 
šput
 = 
¡r
[
šdex
];

169 
isfš®
 = 
cur_¡©e
;

171 
i
 = 0; i < 
»gexp_m©ch”
.
f§
.
acû±
.
	`size
(); i++){

172 
j
 = 0; j < 
isfš®
.
	`size
(); j++){

173 if(
»gexp_m©ch”
.
f§
.
acû±
[
i
] =ğ()(
isfš®
[
j
]-'0'))

174  
Œue
;

177  
çl£
;

178 
	}
}

180 
	g¡d
::
¡ršg
 
	$Check_•sÚ
(cÚ¡ 
RegExpM©ch”
& 
»gexp_m©ch”
, 
¡©e
){

181 
¡ack
<> 
¡©e_¡ack
;

182 
£t
<> 
avaabË_¡©e
;

183 
£t
<>::
™”©Ü
 
™”
;

184 
¡ršg
 
şu¡”
;

185 
tİ
,
şu¡”_size
;

188 
¡©e_¡ack
.
	`push
(
¡©e
);

189 
avaabË_¡©e
.
	`š£¹
(
¡©e
);

192 !
¡©e_¡ack
.
	`em±y
()){

193 
tİ
 = 
¡©e_¡ack
.
	`tİ
();

194 
¡©e_¡ack
.
	`pİ
();

196 
i
 = 0; i < 
»gexp_m©ch”
.
¡Üage
.
	`size
(); i++){

198 if(
»gexp_m©ch”
.
¡Üage
[
i
].
¡©e
 =ğ
tİ
 &&„egexp_m©ch”.¡Üage[i].
šput
 == 0){

199 
şu¡”_size
 = 
avaabË_¡©e
.
	`size
();

201 
avaabË_¡©e
.
	`š£¹
(
»gexp_m©ch”
.
¡Üage
[
i
].
Ãxt_¡©e
);

205 if(
avaabË_¡©e
.
	`size
(è!ğ
şu¡”_size
)

206 
¡©e_¡ack
.
	`push
(
»gexp_m©ch”
.
¡Üage
[
i
].
Ãxt_¡©e
);

212 
™”
 = 
avaabË_¡©e
.
	`begš
(); i‹¸!ğavaabË_¡©e.
	`’d
(); iter++)

213 
şu¡”
.
	`­³nd
(
	`IÁeg”_to_¡ršg
(*
™”
));

215  
şu¡”
;

216 
	}
}

218 
	g¡d
::
¡ršg
 
	$Check_Ãxt
(cÚ¡ 
RegExpM©ch”
& 
»gexp_m©ch”
, 
¡©e
, 
šput
){

219 
¡ršg
 
cur_¡©e
;

220 
¡ršg
 
Ãxt_şu¡”
,
Ãxt_¡ršg
;

221 
£t
<> 
Ãxt_£t
;

222 
£t
<>::
™”©Ü
 
™”
;

223 
cur_p›û
,
Ãxt_¡©e
;

226 
cur_¡©e
 = 
	`Check_•sÚ
(
»gexp_m©ch”
, 
¡©e
);

228 
i
 = 0; i < 
cur_¡©e
.
	`size
(); i++){

230 
cur_p›û
 = ()(
cur_¡©e
.
	`©
(
i
) - '0');

231 
j
 = 0; j < 
»gexp_m©ch”
.
¡Üage
.
	`size
(); j++){

233 if(
cur_p›û
 =ğ
»gexp_m©ch”
.
¡Üage
[
j
].
¡©e
 && 
šput
 ==„egexp_matcher.storage[j].input){

234 
Ãxt_£t
.
	`š£¹
(
»gexp_m©ch”
.
¡Üage
[
j
].
Ãxt_¡©e
);

239 
™”
 = 
Ãxt_£t
.
	`begš
(); i‹¸!ğÃxt_£t.
	`’d
(); iter++){

241 
Ãxt_şu¡”
 = 
	`Check_•sÚ
(
»gexp_m©ch”
, *
™”
);

243 
i
 = 0; i < 
Ãxt_şu¡”
.
	`size
(); i++){

244 
Ãxt_¡©e
 = ()(
Ãxt_şu¡”
[
i
] - '0');

245 
Ãxt_£t
.
	`š£¹
(
Ãxt_¡©e
);

249 
™”
 = 
Ãxt_£t
.
	`begš
(); i‹¸!ğÃxt_£t.
	`’d
(); iter++){

250 
Ãxt_¡ršg
.
	`­³nd
(
	`IÁeg”_to_¡ršg
(*
™”
));

252  
Ãxt_¡ršg
;

253 
	}
}

255 
	g¡d
::
¡ršg
 
	$Fšd_Ãxt
(cÚ¡ 
RegExpM©ch”
& 
»gexp_m©ch”
, 
¡d
::
¡ršg
 
¡©e
, 
šput
){

256 
cur_p›û
,
Ãxt_p›û
;

257 
¡ršg
 
Ãxt_şu¡”
, 
Ãxt_¡ršg
;

258 
£t
<> 
Ãxt_£t
;

259 
£t
<>::
™”©Ü
 
™”
;

264 
i
 = 0; i < 
¡©e
.
	`size
(); i++){

265 
cur_p›û
 = ()(
¡©e
[
i
] - '0');

266 
Ãxt_şu¡”
 = 
	`Check_Ãxt
(
»gexp_m©ch”
,
cur_p›û
,
šput
);

271 
j
 = 0; j < 
Ãxt_şu¡”
.
	`size
(); j++){

272 
Ãxt_p›û
 = ()(
Ãxt_şu¡”
[
j
] - '0');

273 
Ãxt_£t
.
	`š£¹
(
Ãxt_p›û
);

277 
™”
 = 
Ãxt_£t
.
	`begš
(); i‹¸!ğÃxt_£t.
	`’d
(); iter++)

278 
Ãxt_¡ršg
.
	`­³nd
(
	`IÁeg”_to_¡ršg
(*
™”
));

280  
Ãxt_¡ršg
;

281 
	}
}

285 
	$Make_nç_bË
(
RegExpM©ch”
 *
»gexp_m©ch”
){

286 
¡ack
<
¡ršg
> 
¡©e_¡ack
;

287 
£t
<>::
™”©Ü
 
™”
;

288 
£t
<
¡ršg
> 
exi¡
;

290 
¡ršg
 
cur_¡©e
 = 
	`IÁeg”_to_¡ršg
(1);

291 
¡ršg
 
Œªs™iÚ
,
Ãxt_¡©e
;

293 
¡©e_¡ack
.
	`push
(
cur_¡©e
);

294 
exi¡
.
	`š£¹
(
cur_¡©e
);

296 !
¡©e_¡ack
.
	`em±y
()){

297 
cur_¡©e
 = 
¡©e_¡ack
.
	`tİ
();

299 
¡©e_¡ack
.
	`pİ
();

300 
™”
 = 
»gexp_m©ch”
->
f§
.
šput_li¡
.
	`begš
(); i‹¸!ğ»gexp_m©ch”->f§.šput_li¡.
	`’d
(); iter++){

304 
Ãxt_¡©e
 = 
	`Fšd_Ãxt
(*
»gexp_m©ch”
,
cur_¡©e
,*
™”
);

305 
Œªs™iÚ
 = 
cur_¡©e
 + *
™”
;

308 
»gexp_m©ch”
->
f§
.
bË
[
Œªs™iÚ
] = 
Ãxt_¡©e
;

311 if(
cur_¡©e
 !ğ
Ãxt_¡©e
 && 
exi¡
.
	`fšd
Òext_¡©eè=ğexi¡.
	`’d
()){

312 
¡©e_¡ack
.
	`push
(
Ãxt_¡©e
);

313 
exi¡
.
	`š£¹
(
Ãxt_¡©e
);

317 
	}
}

319 
¡ršg
 
	$IÁeg”_to_¡ršg
(
num
){

320 
¡ršg
 
¡r
;

321 
tmp_ch¬
;

324 
tmp_ch¬
 = ()
num
 + '0';

326 
¡r
 = 
tmp_ch¬
;

328  
¡r
;

329 
	}
}

330 
	$Check_Ü
(
CÚ¡
 *
»gexp
, 
RegExpM©ch”
 *
»gexp_m©ch”
, *
cur_¡©e
, *
Ãxt_¡©e
, * 
šdex
){

331 
§ve_befÜe
;

334 
i
 = 0; i < 
»gexp_m©ch”
->
¡Üage
.
	`size
(); i++){

335 if(
»gexp_m©ch”
->
¡Üage
[
i
].
Ãxt_¡©e
 =ğ
cur_¡©e
){

336 
–em
 
befÜe_•sÚ
;

339 
befÜe_•sÚ
.
¡©e
 = 
»gexp_m©ch”
->
¡Üage
[
i
].state;

340 
befÜe_•sÚ
.
šput
 = 0;

341 
befÜe_•¦Ú
.
Ãxt_¡©e
 =‚ext_state + 1;

343 
»gexp_m©ch”
->
¡Üage
.
	`push_back
(
befÜe_•sÚ
);

346 
§ve_befÜe
 = 
»gexp_m©ch”
->
¡Üage
[
i
].
šput
;

347 
»gexp_m©ch”
->
¡Üage
[
i
].
šput
 = 0;

352 
–em
 
befÜe
;

354 
befÜe
.
¡©e
 = 
cur_¡©e
;

355 
befÜe
.
Ãxt_¡©e
 =‚ext_state;

356 
befÜe
.
šput
 = 
§ve_befÜe
;

358 
cur_¡©e
 += 2;

359 
Ãxt_¡©e
 += 2;

362 
–em
 
aá”
;

364 
aá”
.
¡©e
 = 
cur_¡©e
;

365 
aá”
.
Ãxt_¡©e
 =‚ext_state;

366 
aá”
.
šput
 = 
»gexp
[
šdex
+1];

368 
cur_¡©e
++;

369 
Ãxt_¡©e
++;

372 
–em
 
aá”_•sÚ_1
;

374 
aá”_•sÚ_1
.
¡©e
 = 
cur_¡©e
;

375 
aá”_•sÚ_1
.
Ãxt_¡©e
 =‚ext_state;

376 
aá”_•sÚ_1
.
šput
 = 0;

379 
–em
 
aá”_•sÚ_2
;

381 
aá”_•sÚ_2
.
¡©e
 = 
befÜe
.
Ãxt_¡©e
;

382 
aá”_•sÚ_2
.
Ãxt_¡©e
 =‚ext_state;

383 
aá”_•sÚ_2
.
šput
 = 0;

385 
cur_¡©e
++;

386 
Ãxt_¡©e
++;

388 
šdex
 += 2;

389 
	}
}

	@regexp_matcher.h

4 #iâdeà
_PL_HOMEWORK_REGEXP_MATCHER_H_


5 
	#_PL_HOMEWORK_REGEXP_MATCHER_H_


	)

6 
	~<veùÜ
>

7 
	~<m­
>

8 
	~<£t
>

9 
	~<¡ršg
>

10 
	~<¡ack
>

12 
	s–em
{

13 
	m¡©e
;

14 
	mÃxt_¡©e
;

15 
	mšput
;

17 
	sFš™eS‹Autom©Ú
{

18 
	m¡d
::
veùÜ
<> 
acû±
;

19 
	m¡d
::
£t
<> 
šput_li¡
;

20 
	m¡d
::
m­
<
¡d
::
¡ršg
, std::¡ršg> 
bË
;

23 
	sRegExpM©ch”
 {

25 
	m¡d
::
veùÜ
<
–em
> 
¡Üage
;

26 
Fš™eS‹Autom©Ú
 
	mf§
;

30 
boŞ
 
BudRegExpM©ch”
(cÚ¡ * 
»gexp
, 
RegExpM©ch”
* 
»gexp_m©ch”
);

33 
boŞ
 
RunRegExpM©ch”
(cÚ¡ 
RegExpM©ch”
& 
»gexp_m©ch”
, cÚ¡ * 
¡r
);

34 
	g¡d
::
¡ršg
 
Check_•sÚ
(cÚ¡ 
RegExpM©ch”
& 
»gexp_m©ch”
, 
¡©e
);

35 
	g¡d
::
¡ršg
 
Check_Ãxt
(cÚ¡ 
RegExpM©ch”
& 
»gexp_m©ch”
, 
¡©e
, 
šput
);

36 
	g¡d
::
¡ršg
 
Fšd_Ãxt
(cÚ¡ 
RegExpM©ch”
& 
»gexp_m©ch”
, 
¡d
::¡ršg 
¡©e
, 
šput
);

37 
Make_nç_bË
(
RegExpM©ch”
 *
»gexp_m©ch”
);

38 
	g¡d
::
¡ršg
 
IÁeg”_to_¡ršg
(
num
);

39 
Check_Ü
(cÚ¡ *
»gexp
, 
RegExpM©ch”
 *
»gexp_m©ch”
, *
cur_¡©e
, *
Ãxt_¡©e
, *
šdex
);

	@
1
.
0
9
118
fsa.cc
fsa.h
fsa_main.cc
lr_parser.cc
lr_parser.h
lr_parser_main.cc
regexp_main.cc
regexp_matcher.cc
regexp_matcher.h
